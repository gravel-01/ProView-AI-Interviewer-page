<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 可视化模拟面试助手</title>
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 Chart.js 用于可视化报告 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- 引入 Font Awesome 图标 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5', // Indigo 600
                        secondary: '#10B981', // Emerald 500
                        dark: '#1E293B' // Slate 800
                    }
                }
            }
        }
    </script>
    <style>
        /* 自定义滚动条 */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* 脉冲动画（模拟AI说话） */
        @keyframes pulse-ring {
            0% { transform: scale(0.8); box-shadow: 0 0 0 0 rgba(79, 70, 229, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 15px rgba(79, 70, 229, 0); }
            100% { transform: scale(0.8); box-shadow: 0 0 0 0 rgba(79, 70, 229, 0); }
        }
        .ai-speaking { animation: pulse-ring 2s infinite; }
        
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans min-h-screen flex flex-col">

    <!-- 导航栏 -->
    <header class="bg-white shadow-sm border-b border-slate-200 py-4 px-6 flex justify-between items-center sticky top-0 z-50">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-primary rounded-xl flex items-center justify-center text-white font-bold text-xl">
                <i class="fa-solid fa-robot"></i>
            </div>
            <h1 class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-purple-600">AI 面试官 Pro</h1>
        </div>
        <div class="flex items-center gap-4 text-sm text-slate-500">
            <span id="current-time"><i class="fa-regular fa-clock mr-1"></i> 系统就绪</span>
            <div class="w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center border border-slate-300">
                <i class="fa-solid fa-user text-slate-500"></i>
            </div>
        </div>
    </header>

    <!-- 主体容器 -->
    <main class="flex-1 w-full max-w-7xl mx-auto p-4 md:p-6 flex flex-col relative overflow-hidden">

        <!-- 视图 1：面试配置区 (工作流起点) -->
        <div id="view-setup" class="fade-in flex-1 flex flex-col items-center justify-center">
            <div class="bg-white rounded-2xl shadow-xl border border-slate-100 p-8 w-full max-w-2xl">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold text-slate-800 mb-2">定制您的模拟面试</h2>
                    <p class="text-slate-500">配置面试参数，AI将为您生成专属面试场景与题库</p>
                </div>

                <form id="setup-form" class="space-y-6">
                    <!-- 岗位配置 -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-slate-700">目标岗位 <span class="text-red-500">*</span></label>
                            <input type="text" id="job-title" placeholder="例如：前端开发工程师、产品经理" class="w-full px-4 py-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-primary focus:border-primary outline-none transition-all" required value="高级前端开发工程师">
                        </div>
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-slate-700">面试轮次</label>
                            <select id="interview-type" class="w-full px-4 py-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-primary focus:border-primary outline-none bg-white">
                                <option value="technical">技术面 / 专业面</option>
                                <option value="hr">HR面 / 综合素质面</option>
                                <option value="manager">主管面 / 业务面</option>
                            </select>
                        </div>
                    </div>

                    <!-- 难度与偏好 -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-slate-700">难度级别</label>
                            <select id="difficulty" class="w-full px-4 py-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-primary outline-none bg-white">
                                <option value="junior">初级 (基础概念为主)</option>
                                <option value="mid" selected>中级 (实战与原理)</option>
                                <option value="senior">高级 (架构与深度探究)</option>
                            </select>
                        </div>
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-slate-700">面试风格</label>
                            <select id="style" class="w-full px-4 py-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-primary outline-none bg-white">
                                <option value="friendly">温和引导型</option>
                                <option value="strict" selected>严肃高压型</option>
                                <option value="structured">结构化提问</option>
                            </select>
                        </div>
                    </div>

                    <!-- 简历上传 (模拟) -->
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-slate-700">导入简历 (可选，支持 PDF/Word)</label>
                        <div class="border-2 border-dashed border-slate-300 rounded-lg p-6 text-center hover:bg-slate-50 transition-colors cursor-pointer" id="resume-upload">
                            <i class="fa-solid fa-cloud-arrow-up text-3xl text-slate-400 mb-2"></i>
                            <p class="text-sm text-slate-500">点击或拖拽文件到此处上传，AI将根据简历深入挖掘</p>
                        </div>
                    </div>

                    <button type="button" onclick="startInterview()" class="w-full bg-primary hover:bg-indigo-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-indigo-200 transition-all transform hover:-translate-y-1 flex items-center justify-center gap-2 text-lg">
                        <i class="fa-solid fa-play"></i> 开始沉浸式模拟面试
                    </button>
                </form>
            </div>
        </div>

        <!-- 视图 2：沉浸式面试房间 (工作流核心) -->
        <div id="view-interview" class="hidden h-full flex flex-col md:flex-row gap-6">
            <!-- 左侧：AI 面试官界面 -->
            <div class="w-full md:w-1/2 flex flex-col bg-slate-900 rounded-2xl overflow-hidden shadow-xl relative">
                <!-- 顶部状态 -->
                <div class="absolute top-0 left-0 w-full p-4 flex justify-between items-center z-10 bg-gradient-to-b from-black/60 to-transparent text-white">
                    <div class="flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></span>
                        <span class="text-sm font-medium tracking-wider">REC 面试录制中</span>
                    </div>
                    <div id="timer" class="text-sm font-mono bg-black/40 px-3 py-1 rounded-md border border-white/10">00:00</div>
                </div>

                <!-- AI 可视化主体 -->
                <div class="flex-1 flex flex-col items-center justify-center p-8 relative">
                    <!-- 背景波纹 -->
                    <div class="absolute inset-0 flex items-center justify-center opacity-20 pointer-events-none">
                        <div class="w-64 h-64 border-2 border-primary rounded-full absolute mix-blend-screen"></div>
                        <div class="w-96 h-96 border border-purple-500 rounded-full absolute mix-blend-screen transform rotate-45"></div>
                    </div>
                    
                    <!-- AI 头像 -->
                    <div id="ai-avatar-container" class="relative z-10 mb-8">
                        <div class="w-32 h-32 rounded-full bg-gradient-to-br from-primary to-purple-600 p-1 shadow-2xl shadow-primary/40 ai-speaking" id="ai-ring">
                            <div class="w-full h-full bg-slate-900 rounded-full flex items-center justify-center text-5xl text-white">
                                <i class="fa-solid fa-robot"></i>
                            </div>
                        </div>
                    </div>

                    <!-- 实时字幕 -->
                    <div class="mt-auto w-full max-w-md bg-black/50 backdrop-blur-md rounded-xl p-4 border border-white/10 min-h-[80px] flex items-center justify-center text-center transition-all">
                        <p id="ai-subtitle" class="text-white text-lg font-medium leading-relaxed">正在初始化面试环境，请准备...</p>
                    </div>
                </div>

                <!-- 底部控制栏 -->
                <div class="bg-black/80 p-4 flex justify-center items-center gap-6 border-t border-white/10">
                    <button class="w-12 h-12 rounded-full bg-slate-700 hover:bg-slate-600 text-white flex items-center justify-center transition-colors tooltip">
                        <i class="fa-solid fa-microphone"></i>
                    </button>
                    <button class="w-12 h-12 rounded-full bg-slate-700 hover:bg-slate-600 text-white flex items-center justify-center transition-colors">
                        <i class="fa-solid fa-video"></i>
                    </button>
                    <button onclick="endInterview()" class="px-6 h-12 rounded-full bg-red-500 hover:bg-red-600 text-white font-medium flex items-center justify-center gap-2 transition-colors ml-4">
                        <i class="fa-solid fa-phone-slash"></i> 结束面试
                    </button>
                </div>
            </div>

            <!-- 右侧：交互与辅助面板 -->
            <div class="w-full md:w-1/2 flex flex-col bg-white rounded-2xl shadow-xl border border-slate-200 h-[600px] md:h-auto">
                <div class="p-4 border-b border-slate-100 flex justify-between items-center bg-slate-50 rounded-t-2xl">
                    <h3 class="font-bold text-slate-800"><i class="fa-regular fa-comments text-primary mr-2"></i>面试交互记录</h3>
                    <span class="text-xs bg-indigo-100 text-primary px-2 py-1 rounded-md" id="status-badge">AI 思考中...</span>
                </div>
                
                <!-- 聊天记录区 -->
                <div id="chat-box" class="flex-1 p-4 overflow-y-auto space-y-4">
                    <!-- 动态生成消息 -->
                </div>

                <!-- 输入区 -->
                <div class="p-4 bg-slate-50 border-t border-slate-100 rounded-b-2xl">
                    <div class="flex gap-2 relative">
                        <textarea id="user-input" rows="2" class="flex-1 px-4 py-3 rounded-xl border border-slate-300 focus:ring-2 focus:ring-primary focus:border-primary outline-none resize-none text-sm" placeholder="输入您的回答，或点击左侧麦克风语音回答..."></textarea>
                        <button onclick="submitAnswer()" id="send-btn" class="absolute right-3 bottom-3 w-10 h-10 bg-primary hover:bg-indigo-700 text-white rounded-lg flex items-center justify-center transition-colors shadow-md disabled:opacity-50">
                            <i class="fa-solid fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 视图 3：评估报告 (工作流终点) -->
        <div id="view-report" class="hidden flex-1 fade-in h-full overflow-y-auto pb-10">
            <div class="flex justify-between items-end mb-6">
                <div>
                    <h2 class="text-3xl font-bold text-slate-800 mb-2">面试评估报告</h2>
                    <p class="text-slate-500" id="report-meta">高级前端开发工程师 · 技术面 · 中级难度</p>
                </div>
                <button onclick="resetApp()" class="px-4 py-2 border border-slate-300 rounded-lg text-slate-600 hover:bg-slate-50 transition-colors">
                    <i class="fa-solid fa-rotate-right mr-1"></i> 开启新面试
                </button>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- 综合得分卡 -->
                <div class="lg:col-span-1 bg-white rounded-2xl shadow-sm border border-slate-200 p-6 flex flex-col items-center justify-center text-center">
                    <div class="relative w-40 h-40 mb-4">
                        <svg class="w-full h-full transform -rotate-90" viewBox="0 0 36 36">
                            <path class="text-slate-100" stroke-width="3" stroke="currentColor" fill="none" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                            <path class="text-primary transition-all duration-1000 ease-out" id="score-circle" stroke-width="3" stroke-dasharray="85, 100" stroke-linecap="round" stroke="currentColor" fill="none" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                        </svg>
                        <div class="absolute inset-0 flex flex-col items-center justify-center">
                            <span class="text-4xl font-extrabold text-slate-800">85</span>
                            <span class="text-xs text-slate-500">/ 100</span>
                        </div>
                    </div>
                    <h3 class="text-xl font-bold text-slate-800">表现良好</h3>
                    <p class="text-sm text-slate-500 mt-2">您的专业基础扎实，但在沟通逻辑和部分底层原理上还有提升空间。击败了 78% 的候选人。</p>
                </div>

                <!-- 雷达图评估维度 -->
                <div class="lg:col-span-2 bg-white rounded-2xl shadow-sm border border-slate-200 p-6">
                    <h3 class="font-bold text-slate-800 mb-4 border-b pb-2">能力维度雷达图</h3>
                    <div class="w-full h-64 flex justify-center">
                        <canvas id="radarChart"></canvas>
                    </div>
                </div>

                <!-- 详细评价与建议 -->
                <div class="lg:col-span-3 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-emerald-50 rounded-2xl p-6 border border-emerald-100">
                        <h3 class="font-bold text-emerald-800 mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-circle-check text-emerald-500"></i> 亮点与优势 (Strengths)
                        </h3>
                        <ul class="space-y-3 text-emerald-900 text-sm list-disc list-inside">
                            <li>对基础概念（如闭包、原型链）理解深刻，能结合实际业务场景说明。</li>
                            <li>代码规范意识强，提到了模块化和组件化设计的最佳实践。</li>
                            <li>面对压力测试时情绪稳定，态度积极。</li>
                        </ul>
                    </div>

                    <div class="bg-amber-50 rounded-2xl p-6 border border-amber-100">
                        <h3 class="font-bold text-amber-800 mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-triangle-exclamation text-amber-500"></i> 待提升项 (Weaknesses)
                        </h3>
                        <ul class="space-y-3 text-amber-900 text-sm list-disc list-inside">
                            <li>在回答系统架构级问题时，逻辑略显发散，建议采用 STAR 原则构建回答框架。</li>
                            <li>对于最新的前端框架底层渲染机制（如 React Fiber）的理解不够深入。</li>
                            <li>部分问题回答语速过快，缺乏停顿思考的缓冲。</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <!-- JS 逻辑控制 -->
    <script>
        // --- 状态管理 ---
        let currentView = 'setup';
        let interviewTimer = null;
        let secondsElapsed = 0;
        let isAiSpeaking = false;
        
        // 模拟面试题库流程
        const interviewScript = [
            "你好，我是今天的AI面试官。我已经阅读了您的基本信息。首先，能用一分钟简单做一个自我介绍吗？",
            "好的，感谢你的介绍。我注意到你申请的是高级职位。你能详细谈谈在你过往的项目中，遇到过最具挑战性的技术难题是什么，以及你是如何解决它的吗？",
            "明白。那么从架构设计的角度来看，如果让你从零主导设计一个高并发的系统或复杂的前端应用，你通常会如何进行技术选型和性能优化？",
            "最后一个问题，你对未来的职业发展有什么规划？以及，你有什么问题想要问我的吗？"
        ];
        let currentQuestionIndex = 0;

        // --- 视图切换逻辑 ---
        function switchView(viewId) {
            document.getElementById('view-setup').classList.add('hidden');
            document.getElementById('view-interview').classList.add('hidden');
            document.getElementById('view-report').classList.add('hidden');
            
            document.getElementById(`view-${viewId}`).classList.remove('hidden');
            document.getElementById(`view-${viewId}`).classList.add('fade-in');
            currentView = viewId;
        }

        // --- 步骤 1: 开始面试 ---
        function startInterview() {
            const jobTitle = document.getElementById('job-title').value;
            if(!jobTitle) {
                alert("请输入目标岗位");
                return;
            }
            
            // 更新报告元数据
            const type = document.getElementById('interview-type').options[document.getElementById('interview-type').selectedIndex].text;
            document.getElementById('report-meta').innerText = `${jobTitle} · ${type}`;

            switchView('interview');
            startTimer();
            
            // 清空聊天记录
            document.getElementById('chat-box').innerHTML = '';
            currentQuestionIndex = 0;

            // 模拟AI开场
            setTimeout(() => {
                triggerAiSpeak(interviewScript[0]);
            }, 1000);
        }

        // --- 步骤 2: 面试交互逻辑 ---
        function triggerAiSpeak(text) {
            isAiSpeaking = true;
            document.getElementById('ai-ring').classList.add('ai-speaking');
            document.getElementById('status-badge').innerText = 'AI 讲话中...';
            document.getElementById('status-badge').className = 'text-xs bg-indigo-100 text-primary px-2 py-1 rounded-md';
            document.getElementById('send-btn').disabled = true;

            // 模拟字幕打字机效果
            const subtitleEl = document.getElementById('ai-subtitle');
            subtitleEl.innerText = "";
            let i = 0;
            const typingInterval = setInterval(() => {
                subtitleEl.innerText += text.charAt(i);
                i++;
                if (i >= text.length) {
                    clearInterval(typingInterval);
                    finishAiSpeak(text);
                }
            }, 50); // 打字速度
        }

        function finishAiSpeak(fullText) {
            isAiSpeaking = false;
            document.getElementById('ai-ring').classList.remove('ai-speaking');
            document.getElementById('status-badge').innerText = '等待您的回答...';
            document.getElementById('status-badge').className = 'text-xs bg-emerald-100 text-emerald-600 px-2 py-1 rounded-md';
            document.getElementById('send-btn').disabled = false;
            document.getElementById('user-input').focus();
            
            appendMessage('ai', fullText);
        }

        function submitAnswer() {
            if (isAiSpeaking) return;
            const inputEl = document.getElementById('user-input');
            const text = inputEl.value.trim();
            
            if (!text) return;

            appendMessage('user', text);
            inputEl.value = '';
            
            // 模拟AI思考并进行下一问
            document.getElementById('status-badge').innerText = 'AI 思考中...';
            document.getElementById('status-badge').className = 'text-xs bg-amber-100 text-amber-600 px-2 py-1 rounded-md';
            
            setTimeout(() => {
                currentQuestionIndex++;
                if (currentQuestionIndex < interviewScript.length) {
                    triggerAiSpeak(interviewScript[currentQuestionIndex]);
                } else {
                    triggerAiSpeak("非常感谢你的解答。今天的面试就到这里结束了，稍后系统会为您生成详细的评估报告。祝您好运！");
                    setTimeout(() => {
                        endInterview();
                    }, 5000);
                }
            }, 1500);
        }

        function appendMessage(role, text) {
            const chatBox = document.getElementById('chat-box');
            const msgDiv = document.createElement('div');
            
            if (role === 'ai') {
                msgDiv.className = 'flex gap-3 max-w-[85%] fade-in';
                msgDiv.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-gradient-to-br from-primary to-purple-600 flex-shrink-0 flex items-center justify-center text-white text-xs shadow-sm">
                        <i class="fa-solid fa-robot"></i>
                    </div>
                    <div class="bg-slate-100 text-slate-800 px-4 py-3 rounded-2xl rounded-tl-none shadow-sm text-sm leading-relaxed">
                        ${text}
                    </div>
                `;
            } else {
                msgDiv.className = 'flex gap-3 max-w-[85%] self-end ml-auto justify-end fade-in';
                msgDiv.innerHTML = `
                    <div class="bg-primary text-white px-4 py-3 rounded-2xl rounded-tr-none shadow-sm text-sm leading-relaxed">
                        ${text}
                    </div>
                    <div class="w-8 h-8 rounded-full bg-slate-200 flex-shrink-0 flex items-center justify-center text-slate-600 text-xs shadow-sm border border-slate-300">
                        <i class="fa-solid fa-user"></i>
                    </div>
                `;
            }
            
            chatBox.appendChild(msgDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        // 计时器
        function startTimer() {
            secondsElapsed = 0;
            const timerEl = document.getElementById('timer');
            clearInterval(interviewTimer);
            interviewTimer = setInterval(() => {
                secondsElapsed++;
                const m = Math.floor(secondsElapsed / 60).toString().padStart(2, '0');
                const s = (secondsElapsed % 60).toString().padStart(2, '0');
                timerEl.innerText = `${m}:${s}`;
            }, 1000);
        }

        // --- 步骤 3: 结束并生成报告 ---
        function endInterview() {
            clearInterval(interviewTimer);
            document.getElementById('ai-ring').classList.remove('ai-speaking');
            switchView('report');
            initRadarChart();
            
            // 动画圆形进度条
            setTimeout(() => {
                document.getElementById('score-circle').setAttribute('stroke-dasharray', '85, 100');
            }, 300);
        }

        function resetApp() {
            switchView('setup');
        }

        // --- 图表渲染 ---
        let radarChartInstance = null;
        function initRadarChart() {
            const ctx = document.getElementById('radarChart').getContext('2d');
            
            if(radarChartInstance) {
                radarChartInstance.destroy();
            }

            radarChartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['专业技能', '逻辑思维', '沟通表达', '抗压能力', '文化契合度', '项目经验'],
                    datasets: [{
                        label: '能力评估',
                        data: [90, 80, 75, 85, 90, 88],
                        backgroundColor: 'rgba(79, 70, 229, 0.2)', // primary color alpha
                        borderColor: 'rgba(79, 70, 229, 1)',
                        pointBackgroundColor: 'rgba(79, 70, 229, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(79, 70, 229, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(0, 0, 0, 0.1)' },
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            pointLabels: {
                                font: { family: 'sans-serif', size: 12, weight: 'bold' },
                                color: '#475569'
                            },
                            ticks: { display: false, min: 0, max: 100 }
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        // 监听回车键发送
        document.getElementById('user-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                submitAnswer();
            }
        });

    </script>
</body>
</html>
